# Письма фронтовиков | Оживляем историю

Проект для студенческого Хакатона Победы, разработанный командой Эспада. Веб-платформа для преобразования исторических писем времен Великой Отечественной войны в анимированные видеоистории с использованием искусственного интеллекта.

## Интеллектуальный анализ писем

Наша система использует модели искусственного интеллекта для глубокого анализа текста писем, что позволяет создавать максимально достоверные и эмоционально насыщенные видеоистории. Анализ включает:

1. **Определение тональности текста**
   Алгоритмы анализируют эмоциональную окраску письма, выявляя ключевые настроения:
   - Радость и надежда
   - Тревога и беспокойство
   - Грусть и тоска
   - Нейтральное повествование

2. **Подбор голоса**
   На основе анализа текста система определяет наиболее подходящий голос для озвучки:
   - Мужской или женский (в соответствии с предполагаемым автором письма)
   - Возрастные характеристики
   - Эмоциональную окраску речи

3. **Форматирование субтитров**
   Текст автоматически разбивается на удобочитаемые блоки с учетом:
   - Смысловых пауз
   - Эмоциональных акцентов
   - Оптимальной длины строк

4. **Генерация промптов для иллюстраций**
   Система создает детальные описания для визуализации сцен:
   - Исторически достоверные детали
   - Эмоциональную атмосферу
   - Композиционные решения

## Пример анализа письма

Наша языковая модель возвращает структурированные данные в формате JSON, например:

```json
{
  "text": "Здравствуйте, мама, брат и сестра! Примите мой родной боевой с фронта...",
  "voice_gender": "male",
  "voice_mood": "neutral",
  "subtitles": "Здравствуйте, мама, брат и сестра!\nПримите мой родной боевой с фронта...",
  "photo_prompt": "Солдат в поношенной форме пишет письмо при свете керосиновой лампы..."
}
```

## Преимущества нашего подхода

1. **Историческая достоверность**
   Все элементы видео (голос, изображения, стиль) соответствуют эпохе Великой Отечественной войны.

2. **Эмоциональная точность**
   Система улавливает тончайшие нюансы настроения письма, передавая их через голос и визуальный ряд.

3. **Автоматизированная адаптация**
   Каждое письмо обрабатывается индивидуально, с учетом его уникальных особенностей.

4. **Сохранение авторского стиля**
   Оригинальный текст письма остается неизменным, все изменения касаются только формы подачи.

5. **Гибкость настроек**
   Пользователи могут корректировать параметры генерации под свои нужды.

## Техническая реализация

Для анализа текста мы используем:
- Модели Llama и DeepSeak для семантического анализа
- Кастомные алгоритмы определения эмоциональной окраски
- Исторические базы данных для верификации контекста
- Нейросетевые классификаторы для определения характеристик голоса

Процесс полностью автоматизирован и занимает в среднем 3-5 минут на одно письмо стандартного объема.

## Технологический стек

**Frontend:**
- Next.js 13 (App Router) - для высокопроизводительного рендеринга и SEO-оптимизации
- React 18 - построение интерактивного пользовательского интерфейса
- Tailwind CSS - утилитарный CSS-фреймворк для быстрой стилизации
- Framer Motion - библиотека для плавных анимаций интерфейса
- shadcn/ui - набор доступных UI-компонентов

**Backend:**
- .NET Core 9 - высокопроизводительный бэкенд на C#
- Python 3.10 - для ML-сервисов и обработки естественного языка
- PostgreSQL - надежная реляционная СУБД для хранения данных

**ML-сервисы:**
- Llama 2 13B - для семантического анализа текста
- Stable Diffusion XL - генерация исторически достоверных изображений
- FFmpeg - сборка финального видео

**ML-сервисы (удалённые):**
- Yandex SpeechKit - синтез речи с эмоциональной окраской
- DALEE - удаленная генерация изображений
- DeepSeak - для удалённого семантического анализа текста

**Инфраструктура:**
- Docker - контейнеризация сервисов
- Docker Compose - оркестрация в продакшене
- Kafka - асинхронная обработка задач
- MinIO - S3-совместимое хранилище медиа

## Как это работает: подробный процесс генерации

1. **Загрузка и предварительная обработка**
   - Пользователь загружает текст письма через веб-интерфейс или API
   - Система выполняет нормализацию текста (удаление мета-информации)
   - Проводится проверка на запрещенный контент и историческую достоверность

2. **Глубокий анализ текста**
   - Разбивка на смысловые отрезки (абзацы)
   - Определение эмоционального тона каждого сегмента
   - Выявление ключевых сущностей, которые участвуют в повествовании

3. **Подготовка метаданных**
   - Генерация промптов для иллюстраций с историческим контекстом
   - Подбор параметров голоса (пол, эмоциональная окраска)
   - Форматирование субтитров с учетом пауз и ударений

4. **Генерация**
   - Создание аудиодорожки через синтезатор речи
   - Генерация изображений по сформированным промптам
   - Подготовка анимационных переходов между сценами

5. **Сборка видео**
   - Синхронизация аудио и визуального ряда
   - Наложение субтитров с учетом времени появления
   - Применение цветокоррекции и исторических фильтров
   - Экспорт в форматах MP4 (H.264) и WebM

6. **Постобработка**
   - Приведение к нужному цветовому стилю
   - Сохранение в хранилище и индексация

## Установка и запуск

### Требования
- Docker 20.10+
- Docker Compose 2.0+
- 16 ГБ оперативной памяти
- 4+ ядер CPU
- NVIDIA GPU (если требуется генерация изображений на локальной машине)

### Инструкция по развертыванию

1. Клонирование репозитория:
```bash
git clone https://github.com/espada-team/frontline-letters.git
cd frontline-letters
```

2. Настройка окружения:
```bash
cp .env.example .env
# Отредактируйте .env файл согласно вашей конфигурации
```

3. Запуск сервисов:
```bash
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d --build
```

4. Инициализация системы:
```bash
docker-compose exec backend dotnet run --init
```

5. Проверка статуса:
```bash
docker-compose ps
```

Система будет доступна:
- Веб-интерфейс: http://localhost:3000
- API: http://localhost:8000
- Документация API: http://localhost:3000/docs

## Правовые аспекты

1. **Авторские права**
   - Все загружаемые письма должны сопровождаться подтверждением прав на использование
   - Пользователи несут ответственность за содержание загружаемых материалов
   - Система автоматически проверяет тексты на предмет нарушения авторских прав

2. **Персональные данные**
   - Имена и фамилии в письмах автоматически анонимизируются (при генерации)
   - Система не хранит данных пользователей

3. **Историческая достоверность**
   - Применяются автоматические фильтры на предмет исторических неточностей
   - Тексты проверяются на нарушение принципов моралий и законов
   - Все сгенерированные материалы маркируются как "художественная реконструкция"

4. **Этические нормы**
   - Запрещено использование системы для:
      - Искажения исторических фактов
      - Пропаганды насилия
      - Разжигания межнациональной розни
   - Реализована трехуровневая система модерации контента
     1. Проверка при загрузке письма
     2. Проверка перед началом обработки
     3. Проверка после завершения обработки

## Команда Эспада

**Разработка:**
- Хлынин Роман - backend разработчик (C#/.NET)
- Шевченко Рудольф, Дорошко Максим - frontend разработчик (Next.js)
- Папин Николай, Дорошко Максим - инженер ML (Python)

**Дизайн и UX:**
- Кривошеева Екатерина - UX/UI дизайнер

Проект разработан в рамках Хакатона Победы 2025.
